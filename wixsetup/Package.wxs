<Wix xmlns="http://wixtoolset.org/schemas/v4/wxs"
	 xmlns:netfx="http://wixtoolset.org/schemas/v4/wxs/netfx"
	 xmlns:http="http://wixtoolset.org/schemas/v4/wxs/http"
	 xmlns:iis="http://wixtoolset.org/schemas/v4/wxs/iis">
	<Package
		Name="$(ProductName)"
		Scope="perMachine"
		Compressed="true"
		Manufacturer="roldaojr"
		Version="1.0.0.0"
		UpgradeCode="351bcfaa-e0e4-44f3-8e7d-a2a34f4f664c">
		<MajorUpgrade DowngradeErrorMessage="!(loc.DowngradeError)" />
		<Media Id="1" Cabinet="install.cab" EmbedCab="yes"/>
		<Feature Id="Main" Title="Main Program Files">
			<ComponentGroupRef Id="app.binaries" />
			<ComponentRef Id="app.shortcuts" />
			<ComponentRef Id="app.certificate"/>
		</Feature>
		<StandardDirectory Id="ProgramFiles6432Folder">
			<Directory Id="INSTALLFOLDER" Name="!(bind.Property.ProductName)">
				<Directory Id="app.binaries"/>
			</Directory>
		</StandardDirectory>
		<Component Id="app.shortcuts" Guid="295aedc7-084a-4353-bf2d-f72e97eb3c3c">
			<Shortcut Name="!(bind.Property.ProductName)"
					  Target="[INSTALLFOLDER]docscan4web.exe"
					  WorkingDirectory="INSTALLFOLDER"
					  Directory="ProgramMenuFolder"/>
			<RemoveFile Id="app.shortcuts.startmenu.remove" Directory="ProgramMenuFolder" Name="$(ProductName)" On="uninstall"/>
			<Shortcut Name="!(bind.Property.ProductName)"
					  Target="[INSTALLFOLDER]docscan4web.exe"
					  WorkingDirectory="INSTALLFOLDER"
					  Directory="StartupFolder"/>
			<RemoveFile Id="app.shortcuts.startup.remove" Directory="StartupFolder" Name="$(ProductName)" On="uninstall"/>
			<RegistryValue Root="HKCU" Key="Software\$(ProductName)" Name="Installed" Value="1" KeyPath="yes"/>
		</Component>
		<Component Id="app.certificate" Guid="88f4d8bf-d64e-4b3e-a451-6c546ccaaa75">
			<iis:Certificate
				Name="DocScan for Web certficate"
				StoreLocation="localMachine"
				StoreName="root"
				BinaryRef="certificate.crt"
				Vital="yes"/>
			<iis:Certificate
				Name="DocScan for Web certficate"
				StoreLocation="localMachine"
				StoreName="my"
				PFXPassword="P@ssw0rd!"
				BinaryRef="certificate.pfx"
				Vital="yes"/>
			<http:SniSslCertificate
				AppId="app.certificate.local"
				HandleExisting="replace"
				Host="docscan4web.localhost.direct"
				Port="8182"
				Store="root"
				Thumbprint="d8c94afdb81f51e7365f719be1705faa27a86e36"/>
		</Component>
	</Package>
	<Fragment>
		<Binary Id="certificate.pfx" SourceFile="certificate.pfx" />
		<Binary Id="certificate.crt" SourceFile="certificate.crt" />
	</Fragment>
</Wix>
